import sqlite3

# Connect to (or create) the database file
conn = sqlite3.connect('game_scores.db')
c = conn.cursor()

# -----------------------------
# Create Users Table
# -----------------------------
c.execute('''
CREATE TABLE IF NOT EXISTS users (
    user_id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    email TEXT UNIQUE NOT NULL,
    role TEXT NOT NULL
)
''')

# -----------------------------
# Create Games Table
# -----------------------------
c.execute('''
CREATE TABLE IF NOT EXISTS games (
    game_id INTEGER PRIMARY KEY AUTOINCREMENT,
    game_name TEXT NOT NULL,
    section TEXT NOT NULL
)
''')

# -----------------------------
# Create Scores Table
# -----------------------------
c.execute('''
CREATE TABLE IF NOT EXISTS scores (
    score_id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER NOT NULL,
    game_id INTEGER NOT NULL,
    score INTEGER NOT NULL,
    date_played DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY(user_id) REFERENCES users(user_id),
    FOREIGN KEY(game_id) REFERENCES games(game_id)
)
''')

# -----------------------------
# Insert Sample Games
# -----------------------------
games = [
    ('Heritage Quiz', 'heritage'),
    ('Word Puzzle', 'heritage'),
    ('Memory Game', 'heritage'),
    ('Maze Puzzle', 'heritage'),
    ('Universe Quiz', 'universe'),
    ('Word Puzzle', 'universe'),
    ('Asteroids Dodge', 'universe'),
    ('Solar Crush', 'universe')
]

# Insert games if not already present
c.executemany('INSERT OR IGNORE INTO games (game_name, section) VALUES (?, ?)', games)

# Commit changes and close connection
conn.commit()
conn.close()

print("Database setup complete! 'game_scores.db' created with tables and sample games.")
